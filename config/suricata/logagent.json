{
  "config": {
    "datadir": "/tmp/suitemon",
    "input": {"maxPending": 1000},
    "buffer": {"maxPending": 1000},
    "processor": {"maxPending": 1000},
    "transporter": {"maxPending": 1000}
  },

  "include" : [
		"./http.json",
		"./alert.json",
		"./dns.json",
		"./tls.json"
	],

  "inputs": {
    "suricata": {
      "type": "file",
      "config": {
        "path": "/var/log/suricata/eve.json*",
        "watch": true,
        "readmode": "watermark",
        "offset": "start"
      }
    }
  },
  "processors": {
    "json": {
      "type": "jsonparser"
    },
		"filter" : {
			"type" : "filter",
			"config" : {
				"mode" : "reject",
				"filter" : "${type}=='stats'"
			}
		},
		"timestamp" : {
			"type" : "timestamp",
			"config" : {
				"output" : "ts"
			}
		},
		"date" : {
			"type" : "dateformat",
			"config" : {
				"field" : "${ts}",
				"format" : "YYYY-MM-DD",
				"output" : "evtdate"
			}
		},
		"time" : {
			"type" : "dateformat",
			"config" : {
				"field" : "${ts}",
				"format" : "HH:mm:ss",
				"output" : "evttime"
			}
		},
		"dbcol" : {
			"type" : "dateformat",
			"config" : {
				"field" : "${timestamp}",
				"format" : "YYYYMMDD",
				"output" : "dbcol"
			}
		},
    "props": {
      "type": "properties",
      "config": {
        "set": {
					"input" : "event",
          "st": "IDS",
					"type" : "${event_type}",
					"res" : "${event_type}"
        }
      }
    }
  },

	"transporters" : {
		"mongo" : {
			"type" : "mongo",
			"config" : {
				"url" : "mongodb://boxica4:27017/boxica",
				"retry" : true,
				"collection" : "events${dbcol}",
				"indexes" : [
	        {"basemsg":1}, {"timestamp":1}, {"evtdate":1}, {"evttime":1},
	        {"et":1}, {"evt":1}, {"rn":1}, {"sn":1}, {"st":1}, {"pn":1},
	        {"res":1}, {"subres":1}, {"sev":1}, {"p":1}, {"sip":1},
	        {"shn":1}, {"sp":1}, {"sun":1}, {"dip":1}, {"dhn":1}, {"dp":1},
	        {"dun":1}, {"fn":1}, {"ei.extra":1}, {"ct1":1}, {"ct2":1},
	        {"ct3":1}, {"ct4":1}, {"ct5":1}, {"ct6":1}, {"ct7":1},
	        {"ct8":1}, {"ct9":1}, {"dbtimestamp":1}, {"type":1},
	        {"queue":1}, {"rule":1}, {"ruleset":1}, {"subevents":1}
				]
			}
		},
		"logger" : {
			"type" : "console",
			"config" : {
				"format" : "${JSON}"
			}
		}
	},

  "flows": [
    {"from": "suricata", "processors" : ["json","filter","timestamp","props","date","time","dbcol"], "transporters": "#"}
  ]
}
