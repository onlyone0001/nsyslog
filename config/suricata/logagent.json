{
  "config": {
    "datadir": "/tmp/suitemon",
    "input": {"maxPending": 1000},
    "buffer": {"maxPending": 1000},
    "processor": {"maxPending": 1000},
    "transporter": {"maxPending": 1000}
  },

  "include" : [
		"./http.json",
		"./alert.json",
		"./dns.json",
		"./tls.json"
	],

  "inputs": {
    "suricata": {
      "type": "file",
      "config": {
        "path": "/var/log/suricata/eve.json",
        "watch": true,
        "readmode": "watermark",
        "offset": "start"
      }
    }
  },
  "processors": {
    "json": {
      "type": "jsonparser"
    },
		"filter" : {
			"type" : "filter",
			"config" : {
				"mode" : "reject",
				"filter" : "${type}=='stats'"
			}
		},
		"timestamp" : {
			"type" : "timestamp",
			"config" : {
				"output" : "ts"
			}
		},
		"date" : {
			"type" : "dateformat",
			"config" : {
				"field" : "${ts}",
				"format" : "YYYY-MM-DD",
				"output" : "evtdate"
			}
		},
		"time" : {
			"type" : "dateformat",
			"config" : {
				"field" : "${ts}",
				"format" : "HH:mm:ss",
				"output" : "evttime"
			}
		},
		"dbcol" : {
			"type" : "dateformat",
			"config" : {
				"field" : "${timestamp}",
				"format" : "YYYYMMDD",
				"output" : "dbcol"
			}
		},
    "props": {
      "type": "properties",
      "config": {
        "set": {
					"input" : "event",
          "st": "IDS",
					"type" : "${event_type}",
					"res" : "${event_type}"
        }
      }
    }
  },

	"transporters" : {
		"mongo" : {
			"type" : "mongo",
			"config" : {
				"url" : "mongodb://boxica4:27017/boxica",
				"retry" : true,
				"collection" : "events${dbcol}",
				"format" : {
					"timestamp" : "${ts}", "et" : "${et}",
					"evtdate" : "${evtdate}", "evttime" : "${evttime}",
					"type" : "${type}", "res" : "${res}", "subres" : "${subres}",
					"et" : "${et}", "st" : "${st}",
					"sip": "${sip}", "sp" : "${sp}",
          "dip" : "${dip}", "dp" : "${dp}",
					"basemsg" : "${basemsg}", "ei" : "${ei}",
          "p" : "${p}", "pn":"${pn}", "fn" : "${fn}",
					"ct1" : "${ct1}",	"ct2" : "${ct2}",	"ct3" : "${ct3}",
					"ct4" : "${ct4}",	"ct5" : "${ct5}",	"ct6" : "${ct6}",
					"ct7" : "${ct7}",	"ct8" : "${ct8}",	"ct9" : "${ct9}"
				}
			}
		},
		"logger" : {
			"type" : "console",
			"config" : {
				"format" : "${JSON}"
			}
		}
	},

  "flows": [
    {"from": "suricata", "processors" : ["json","filter","timestamp","props","date","time","dbcol"], "transporters": "#"}
  ]
}
