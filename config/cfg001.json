{
	"include" : [
		"processors.json"
	],
	"servers" : {
		"udp" : {
			"type" : "udp",
			"config" : {
				"protocol" : "udp4",
				"interface" : "0.0.0.0",
				"port" : "514"
			}
		},
		"tcp" : {
			"type" : "tcp",
			"config" : {
				"protocol" : "tcp",
				"interface" : "0.0.0.0",
				"port" : "514"
			}
		}
	},

	"filters" : {
		"fromUDP" : "${server.protocol}=='udp4'",
		"localhost" : "${client.address}=='127.0.0.1'",
		"interface" : "${client.address}!='127.0.0.1'",
		"httpOk" : "${message}.match(/ 200/)",
		"httpRed" : "${message}.match(/ 302/)",
		"httpErr" : "${message}.match(/ (404|500)/)"
	},

	"filterGroups" : {
	},

	"transporters" : {
		"file1" : {
			"type" : "file",
			"config" : {
				"format" : "${originalMessage}",
				"path" : "/var/log/nsyslog/${host}/${appName}.log"
			}
		},
		"file2" : {
			"type" : "file",
			"config" : {
				"format" : "${timestamp} ${originalMessage}",
				"path" : "/var/log/nsyslog/${host}/${appName}_${prival}.log"
			}
		},
		"log" : {
			"type" : "console",
			"config" : {"format" : "${originalMessage}", "level" : "log"}
		},
		"debug" : {
			"type" : "console",
			"config" : {"format" : "${JSON}", "level" : "debug"}
		},
		"warn" : {
			"type" : "console",
			"config" : {"format" : "${originalMessage}", "level" : "warn"}
		},
		"error" : {
			"type" : "console",
			"config" : {"format" : "${originalMessage}", "level" : "error"}
		}
	},

	"transporterGroups" : {
		"files" : {"mode":"parallel", "transporters":["file1","file2"]}
	},

	"processors" : {
		"host1" : {
			"type" : "properties",
			"config" : {
				"set" : {
					"extra" : {"test1":"${type}"}
				}
			}
		},
		"host2" : {
			"type" : "properties",
			"config" : {
				"set" : {
					"extra" : {"test2":"${facility}"}
				}
			}
		}
	},

	"processorGroups" : {
		"pgroup1" : ["host1","host2"]
	},

	"flows" : [
		{"from":"localhost", "disabled":false, "when":["httpOk"], "transporters":"log", "mode":"serial"},
		{"from":"localhost", "disabled":false, "when":["httpRed"], "transporters":"warn", "mode":"parallel"},
		{"from":"localhost", "disabled":false, "when":["httpErr"], "transporters":"error", "mode":"serial"},
		{"from":"interface", "disabled":false, "parse":true, "processors":["$pgroup1"], "transporters":["debug"], "mode":"serial"},
		{"from":"*", "disabled":false, "parse":false, "transporters":["$files","debug"]}
	]
}
