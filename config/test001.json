{
	"config" : {
		"datadir" : "/tmp/nsyslog",
		"input" : {"maxPending" : 1000},
		"buffer" : {"maxPending": 1000},
		"processor" : {"maxPending": 1000},
		"transporter" : {"maxPending": 1000}
	},

	"inputs" : {
		"file" : {
			"type" : "file",
			"config" : {
				"path" : "/kafka_2.12-0.11.0.2/logs/state-change.log*",
				"watch" : true,
				"readmode" : "watermark",
				"offset" : "start"
			}
		}
	},

	"processors" : {
		"timestamp" : {
			"type" : "timestamp",
			"config" : {}
		},
		"props" : {
			"type" : "properties",
			"config" : {
				"set" : {
					"match" : "${originalMessage.match(/Unknown/)!=null}",
					"proc" : true
				}
			}
		}
	},

	"transporters" : {
		"stat" : {
			"type" : "stat",
			"config" : {
				"threshold" : 1000
			}
		},
		"mongo" : {
			"type" : "mongo",
			"config" : {
				"url" : "mongodb://localhost:27017/test",
				"collection" : "syslog",
				"format" : {
					"path" : "${path}",
					"message" : "${originalMessage}",
					"timestamp": "${timestamp}",
					"extra" : {
						"type" : "${type}",
						"path" : "${path}"
					}
				}
			}
		},
		"log" : {
			"type" : "console",
			"config" : {"format" : "${match} => ${originalMessage}", "level" : "log"}
		},
		"logfile" : {
			"type" : "console",
			"config" : {"format" : "${path} => ${originalMessage}", "level" : "log"}
		},
		"file" : {
			"type" : "file",
			"config" : {
				"path" : "/var/logout/${path}",
				"format" : "${originalMessage}"
			}
		},
		"null" : {
			"type" : "null"
		}
	},

	"flows" : [
		{"from":"${input}=='glob' && !${proc}", "processors":["timestamp","props"], "transporters":["stat","#"]},
		{"from":"${match}=='true'", "processors":["timestamp"], "transporters":"log"},
		{"from":"${input}=='file'", "transporters":"file"}
	]
}
